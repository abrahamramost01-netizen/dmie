<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Domin√≥</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    padding: 20px;
}

h1, h2 {
    text-align: center;
}

.teams {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 15px;
    margin-bottom: 30px;
}

.team-card {
    background: white;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0,0,0,.15);
    transition: transform .3s;
}

.team-card.winner {
    border: 4px solid #28a745;
    background: #eafaf1;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.03); }
    100% { transform: scale(1); }
}

.team-name {
    font-size: 20px;
    font-weight: bold;
}

.team-points {
    font-size: 42px;
    color: #2c7be5;
    margin: 10px 0;
}

.matches {
    background: white;
    padding: 15px;
    border-radius: 8px;
}

.match {
    border-bottom: 1px solid #ddd;
    padding: 10px 0;
}

.match:last-child {
    border-bottom: none;
}

img {
    max-width: 100%;
    border-radius: 6px;
    margin-top: 8px;
}

.badge {
    display: inline-block;
    background: #28a745;
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 12px;
    margin-left: 5px;
}

details {
    background: white;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
}
</style>
</head>

<body>

<h1>üÅ¢ Domin√≥</h1>

<!-- ================= EQUIPOS ================= -->
<h2>Equipos</h2>
<div class="teams">
{% for t in teams %}
    <div class="team-card {% if t.points >= win_points %}winner{% endif %}">
        <div class="team-name">
            {{ t.name }}
            {% if t.points >= win_points %}
                <span class="badge">GANADOR</span>
            {% endif %}
        </div>
        <div class="team-points">{{ t.points }}</div>
        <div>üèÜ Partidas ganadas: {{ t.wins }}</div>
    </div>
{% endfor %}
</div>

<!-- ================= NUEVA PARTIDA ================= -->
<details open>
<summary>üéØ Nueva partida</summary>
<form method="post" action="/add_match" enctype="multipart/form-data">
    <select name="team_id" required>
        <option value="">Equipo perdedor</option>
        {% for t in teams %}
            <option value="{{ t.id }}">{{ t.name }}</option>
        {% endfor %}
    </select>
    <br><br>

    <input type="number" name="points" placeholder="Puntos (opcional)">
    <br><br>

    <input type="file" name="image" accept="image/*">
    <br><br>

    <button>Registrar partida</button>
</form>
</details>

<!-- ================= HISTORIAL ================= -->
<details>
<summary>üìú Historial</summary>

<div class="matches">
{% for m in matches %}
    <div class="match">
        <strong>{{ m.team_name }}</strong>
        +{{ m.points }} puntos
        <br>
        <small>{{ m.created_at }}</small>

        {% if m.image_path %}
            <div>
                <b>Imagen original:</b><br>
                <img src="/{{ m.image_path }}">
            </div>
        {% endif %}

        {% if m.processed_image %}
            <div>
                <b>Imagen procesada:</b><br>
                <img src="/{{ m.processed_image }}">
            </div>
        {% endif %}

        {% if m.details %}
            <details>
                <summary>üßÆ Detalle del c√°lculo</summary>
                <ul>
                {% for d in m.details %}
                    <li>Ficha {{ d.left }} | {{ d.right }} ‚Üí {{ d.sum }} puntos</li>
                {% endfor %}
                </ul>
                <b>Total:</b> {{ m.points }}
            </details>
        {% endif %}
    </div>
{% endfor %}
</div>

</details>

</body>
</html>

